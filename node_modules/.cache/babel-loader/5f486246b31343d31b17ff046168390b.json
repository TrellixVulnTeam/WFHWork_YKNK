{"ast":null,"code":"import _objectSpread from\"F:\\\\New folder\\\\TapaTradieWebsite20-01-2022\\\\WFHWork\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _asyncToGenerator from\"F:\\\\New folder\\\\TapaTradieWebsite20-01-2022\\\\WFHWork\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"F:\\\\New folder\\\\TapaTradieWebsite20-01-2022\\\\WFHWork\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"F:\\\\New folder\\\\TapaTradieWebsite20-01-2022\\\\WFHWork\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import PlacesAutocomplete,{geocodeByAddress,getLatLng}from\"react-places-autocomplete\";import axios from\"axios\";import{useHistory}from\"react-router-dom\";import{ReactComponent as LocationIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/icons/locationSvg.svg\";import LocationIocn from\"../../assets/images/location-icon.svg\";import tradie_service_location_2 from\"../../assets/icons/map-location.svg\";import{useDispatch,useSelector}from\"react-redux\";import*as Actions from\"../../redux/auth/action\";import Geolocation from\"react-geolocation\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{createElement as _createElement}from\"react\";import{Fragment as _Fragment}from\"react/jsx-runtime\";toast.configure();var addrees=\"\";var AutoCompleteSearch=function AutoCompleteSearch(){var _tradiaServiceLocatio;var history=useHistory();var dispatch=useDispatch();var Get_User_Address_Action=Actions.Get_User_Address_Action,Get_Provider_Address_Action=Actions.Get_Provider_Address_Action;var _useSelector=useSelector(function(state){return state.auth;}),tradiaServiceLocation=_useSelector.tradiaServiceLocation,businessUpdateres=_useSelector.businessUpdateres;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),currentLocation=_useState2[0],setCurrentLocation=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),detectButton=_useState4[0],setDetectButton=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),lat=_useState6[0],setLat=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),lng=_useState8[0],setLng=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),status=_useState10[0],setStatus=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),fulladdress=_useState12[0],SetFulladdress=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),searchQuery=_useState14[0],setSeacrhQuery=_useState14[1];var _useState15=useState({locationAdress:\"\",latitude:\"\",longitude:\"\"}),_useState16=_slicedToArray(_useState15,2),searchFormData=_useState16[0],setSearchFormData=_useState16[1];var locationAdress=searchFormData.locationAdress,latitude=searchFormData.latitude,longitude=searchFormData.longitude;var handleChange=function handleChange(value){setSeacrhQuery(value);};var handleSelect=function handleSelect(searchQuery){setSeacrhQuery(searchQuery);geocodeByAddress(searchQuery).then(function(results){addrees=results[0].formatted_address;return getLatLng(results[0]);}).then(function(latLng){setSearchFormData({latitude:latLng.lat,longitude:latLng.lng,locationAdress:addrees});}).catch(function(error){return console.error(\"Error\",error);});};useEffect(function(){dispatch(Get_User_Address_Action());},[]);var splitAddress=locationAdress.split(\",\");var submitServiceLocation=function submitServiceLocation(e){e.preventDefault();if(fulladdress.length>0){var a=fulladdress.length-3;var data=fulladdress[a];var serviceData={address:data.formatted_address,city:data.address_components[0].long_name,country:data.address_components[2].long_name,state:data.address_components[1].long_name,latitude:lat,location_name:\"home\",longitude:lng,online:1,role:\"provider\"};// console.log(\"fulladdress\",serviceData)\ndispatch(Get_Provider_Address_Action(serviceData));setTimeout(function(){dispatch(Get_User_Address_Action());},300);}else if(splitAddress.length===2){var _serviceData={address:locationAdress,city:splitAddress[splitAddress.length-2],country:splitAddress[splitAddress.length-1],state:splitAddress[splitAddress.length-2],latitude:latitude,location_name:\"home\",longitude:longitude,online:1,role:\"provider\"};dispatch(Get_Provider_Address_Action(_serviceData));setTimeout(function(){dispatch(Get_User_Address_Action());},300);}else{var _serviceData2={address:locationAdress,city:splitAddress[splitAddress.length-3],country:splitAddress[splitAddress.length-1],state:splitAddress[splitAddress.length-2],latitude:latitude,location_name:\"home\",longitude:longitude,online:1,role:\"provider\"};dispatch(Get_Provider_Address_Action(_serviceData2));setTimeout(function(){dispatch(Get_User_Address_Action());},300);}};useEffect(function(){if(businessUpdateres){toast.success(businessUpdateres,{position:\"bottom-left\",autoClose:2000,size:\"small\"});setTimeout(function(){history.push(\"/tradie-my-profile\");},2000);}dispatch({type:\"BUSINESSS_DETAILS_UPDATE_SUCCESS\",payloade:\"\"});},[businessUpdateres]);var calllatelong=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(latt,lngg){var url,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// console.log(\"HELLO\" , latt,lngg)\nurl=\"https://maps.googleapis.com/maps/api/geocode/json?latlng=\".concat(latt,\",\").concat(lngg,\"&key=AIzaSyDT6N5TjyH0MjDRAcYLGuiL1otostkeYhs\");_context.next=3;return axios.get(url);case 3:res=_context.sent;// console.log(\"res\",res);\nSetFulladdress(res.data.results);case 5:case\"end\":return _context.stop();}}},_callee);}));return function calllatelong(_x,_x2){return _ref.apply(this,arguments);};}();var getLocation=function getLocation(){if(!navigator.geolocation){setStatus('Geolocation is not supported by your browser');}else{setStatus('Locating...');navigator.geolocation.getCurrentPosition(function(position){setStatus(null);setLat(position.coords.latitude);setLng(position.coords.longitude);calllatelong(position.coords.latitude,position.coords.longitude);},function(){setStatus('Unable to retrieve your location');});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-search location-srch\",children:/*#__PURE__*/_jsx(PlacesAutocomplete,{value:searchQuery,onChange:handleChange,onSelect:handleSelect,children:function children(_ref2){var getInputProps=_ref2.getInputProps,suggestions=_ref2.suggestions,getSuggestionItemProps=_ref2.getSuggestionItemProps,loading=_ref2.loading;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},getInputProps({placeholder:\"Type to search\",className:\"location-search-input\"})),{},{className:\"input-additional-service additional-service-information\"})),/*#__PURE__*/_jsx(\"div\",{className:\"autocomplete-search-dropDown\",style:{marginTop:\"30px\"},children:suggestions.map(function(suggestion,idx){var className=suggestion.active?\"suggestion-item--active\":\"suggestion-item\";// inline style for demonstration purpose\nvar style=suggestion.active?{backgroundColor:\"#ffffff\",cursor:\"pointer\"}:{backgroundColor:\"#ffffff\",cursor:\"pointer\"};return/*#__PURE__*/_createElement(\"div\",_objectSpread(_objectSpread({},getSuggestionItemProps(suggestion,{className:className,style:style})),{},{key:idx}),/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({style:{display:\"flex\",alignItems:\"center\"},className:\"svg-and-location-additional\"},getSuggestionItemProps(suggestion,{className:className// style,\n})),{},{children:[/*#__PURE__*/_jsx(LocationIcon,{height:\"20px\",width:\"20px\",fill:\"grey\"}),/*#__PURE__*/_jsx(\"div\",{className:\"location-input-result\",children:/*#__PURE__*/_jsx(\"p\",{className:\"autocomplete-search-items-additional\"// onClick={handleSelectTerm}\n,children:suggestion.description})})]})));})})]});}})}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"profile-btn detect-location-btn\",onClick:getLocation,children:[/*#__PURE__*/_jsx(\"img\",{className:\"location-icon \",src:LocationIocn,alt:\"icon\"}),\"Detect Current Location\"]})]})}),/*#__PURE__*/_jsx(\"label\",{className:\"m-b-1\",children:\"Recent Location\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group mb-1\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"  \",children:[/*#__PURE__*/_jsx(\"img\",{width:\"20\",height:\"20\",src:tradie_service_location_2,alt:\"\"}),tradiaServiceLocation?(_tradiaServiceLocatio=tradiaServiceLocation[0])===null||_tradiaServiceLocatio===void 0?void 0:_tradiaServiceLocatio.address:\"\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group btn\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",className:\"btn-primary\",onClick:function onClick(e){submitServiceLocation(e);},value:\"Save\"})})]});};export default AutoCompleteSearch;","map":{"version":3,"sources":["F:/New folder/TapaTradieWebsite20-01-2022/WFHWork/src/pages/TradieServiceLocation/AutoLocationComplete.js"],"names":["React","useState","useEffect","PlacesAutocomplete","geocodeByAddress","getLatLng","axios","useHistory","useDispatch","useSelector","Actions","Geolocation","toast","configure","addrees","AutoCompleteSearch","history","dispatch","Get_User_Address_Action","Get_Provider_Address_Action","state","auth","tradiaServiceLocation","businessUpdateres","currentLocation","setCurrentLocation","detectButton","setDetectButton","lat","setLat","lng","setLng","status","setStatus","fulladdress","SetFulladdress","searchQuery","setSeacrhQuery","locationAdress","latitude","longitude","searchFormData","setSearchFormData","handleChange","value","handleSelect","then","results","formatted_address","latLng","catch","error","console","splitAddress","split","submitServiceLocation","e","preventDefault","length","a","data","serviceData","address","city","address_components","long_name","country","location_name","online","role","setTimeout","success","position","autoClose","size","push","type","payloade","calllatelong","latt","lngg","url","get","res","getLocation","navigator","geolocation","getCurrentPosition","coords","getInputProps","suggestions","getSuggestionItemProps","loading","placeholder","className","marginTop","map","suggestion","idx","active","style","backgroundColor","cursor","display","alignItems","description","LocationIocn","tradie_service_location_2"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport PlacesAutocomplete, {\r\n  geocodeByAddress,\r\n  getLatLng,\r\n} from \"react-places-autocomplete\";\r\nimport axios from \"axios\"\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { ReactComponent as LocationIcon } from \"../../assets/icons/locationSvg.svg\";\r\nimport LocationIocn  from \"../../assets/images/location-icon.svg\";\r\nimport tradie_service_location_2 from \"../../assets/icons/map-location.svg\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport * as Actions from \"../../redux/auth/action\";\r\nimport Geolocation from \"react-geolocation\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\ntoast.configure();\r\n\r\nlet addrees = \"\";\r\nconst AutoCompleteSearch = () => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const { Get_User_Address_Action, Get_Provider_Address_Action } = Actions;\r\n\r\n  const { tradiaServiceLocation, businessUpdateres } = useSelector(\r\n    (state) => state.auth\r\n  );\r\n  const [currentLocation, setCurrentLocation] = useState(false);\r\n  const [detectButton, setDetectButton] = useState();\r\n  const [lat, setLat] = useState(null);\r\n    const [lng, setLng] = useState(null);\r\n    const [status, setStatus] = useState(null);\r\n\r\n  const [fulladdress,SetFulladdress] = useState([])\r\n  const [searchQuery, setSeacrhQuery] = useState(\"\");\r\n\r\n  const [searchFormData, setSearchFormData] = useState({\r\n    locationAdress: \"\",\r\n    latitude: \"\",\r\n    longitude: \"\",\r\n  });\r\n\r\n  const { locationAdress, latitude, longitude } = searchFormData;\r\n\r\n  const handleChange = (value) => {\r\n    setSeacrhQuery(value);\r\n  };\r\n  const handleSelect = (searchQuery) => {\r\n    setSeacrhQuery(searchQuery);\r\n\r\n    geocodeByAddress(searchQuery)\r\n      .then((results) => {\r\n        addrees = results[0].formatted_address;\r\n\r\n        return getLatLng(results[0]);\r\n      })\r\n      .then((latLng) => {\r\n        setSearchFormData({\r\n          latitude: latLng.lat,\r\n          longitude: latLng.lng,\r\n          locationAdress: addrees,\r\n        });\r\n      })\r\n      .catch((error) => console.error(\"Error\", error));\r\n  };\r\n\r\n  useEffect(() => {\r\n    dispatch(Get_User_Address_Action());\r\n  }, []);\r\n\r\n  const splitAddress = locationAdress.split(\",\");\r\n\r\n  const submitServiceLocation = (e) => {\r\n    e.preventDefault();\r\n    if(fulladdress.length>0) \r\n    {\r\n  \r\n    let a = fulladdress.length-3 ; \r\n      let data = fulladdress[a]\r\n    \r\n      const serviceData = {\r\n        address: data.formatted_address,\r\n        city: data.address_components[0].long_name,\r\n        country: data.address_components[2].long_name,\r\n        state: data.address_components[1].long_name,\r\n        latitude: lat,\r\n        location_name: \"home\",\r\n        longitude: lng,\r\n        online: 1,\r\n        role: \"provider\",\r\n        \r\n      }\r\n      // console.log(\"fulladdress\",serviceData)\r\n      dispatch(Get_Provider_Address_Action(serviceData));\r\n\r\n      setTimeout(() => {\r\n        dispatch(Get_User_Address_Action());\r\n      }, 300);\r\n      \r\n    }\r\n   else if (splitAddress.length === 2) {\r\n      const serviceData = {\r\n        address: locationAdress,\r\n        city: splitAddress[splitAddress.length - 2],\r\n        country: splitAddress[splitAddress.length - 1],\r\n        state: splitAddress[splitAddress.length - 2],\r\n        latitude: latitude,\r\n        location_name: \"home\",\r\n        longitude: longitude,\r\n        online: 1,\r\n        role: \"provider\",\r\n      };\r\n      dispatch(Get_Provider_Address_Action(serviceData));\r\n\r\n      setTimeout(() => {\r\n        dispatch(Get_User_Address_Action());\r\n      }, 300);\r\n    } else {\r\n      const serviceData = {\r\n        address: locationAdress,\r\n        city: splitAddress[splitAddress.length - 3],\r\n        country: splitAddress[splitAddress.length - 1],\r\n        state: splitAddress[splitAddress.length - 2],\r\n        latitude: latitude,\r\n        location_name: \"home\",\r\n        longitude: longitude,\r\n        online: 1,\r\n        role: \"provider\",\r\n      };\r\n      dispatch(Get_Provider_Address_Action(serviceData));\r\n      setTimeout(() => {\r\n        dispatch(Get_User_Address_Action());\r\n      }, 300);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (businessUpdateres) {\r\n      toast.success(businessUpdateres, {\r\n        position: \"bottom-left\",\r\n        autoClose: 2000,\r\n        size: \"small\",\r\n      });\r\n      setTimeout(() => {\r\n        history.push(\"/tradie-my-profile\");\r\n      }, 2000);\r\n    }\r\n\r\n    dispatch({ type: \"BUSINESSS_DETAILS_UPDATE_SUCCESS\", payloade: \"\" });\r\n  }, [businessUpdateres]);\r\n\r\n  const calllatelong = async (latt,lngg)=>{\r\n    // console.log(\"HELLO\" , latt,lngg)\r\n    const url =\r\n          `https://maps.googleapis.com/maps/api/geocode/json?latlng=${latt},${lngg}&key=AIzaSyDT6N5TjyH0MjDRAcYLGuiL1otostkeYhs`\r\n          const res = await axios.get(url);\r\n          // console.log(\"res\",res);\r\n          SetFulladdress(res.data.results)\r\n        \r\n      }\r\n    \r\n    \r\n      const getLocation = () => {\r\n            if (!navigator.geolocation) {\r\n              setStatus('Geolocation is not supported by your browser');\r\n            } else {\r\n              setStatus('Locating...');\r\n              navigator.geolocation.getCurrentPosition((position) => {\r\n                setStatus(null);\r\n                setLat(position.coords.latitude);\r\n                setLng(position.coords.longitude);\r\n                calllatelong(position.coords.latitude,position.coords.longitude)\r\n               \r\n              }, () => {\r\n                setStatus('Unable to retrieve your location');\r\n              }); \r\n            \r\n            }\r\n            \r\n          }\r\n  return (\r\n    <>\r\n      <div className=\"input-group\">\r\n        <div className=\"\">\r\n          <div className=\"profile-search location-srch\">\r\n            <PlacesAutocomplete\r\n              value={searchQuery}\r\n              onChange={handleChange}\r\n              onSelect={handleSelect}\r\n            >\r\n              {({\r\n                getInputProps,\r\n                suggestions,\r\n                getSuggestionItemProps,\r\n                loading,\r\n              }) => (\r\n                <div>\r\n                  <input\r\n                    {...getInputProps({\r\n                      placeholder: \"Type to search\",\r\n                      className: \"location-search-input\",\r\n                    })}\r\n                    className=\"input-additional-service additional-service-information\"\r\n                  />\r\n                  <div\r\n                    className=\"autocomplete-search-dropDown\"\r\n                    style={{ marginTop: \"30px\" }}\r\n                  >\r\n                    {suggestions.map((suggestion, idx) => {\r\n                      const className = suggestion.active\r\n                        ? \"suggestion-item--active\"\r\n                        : \"suggestion-item\";\r\n                      // inline style for demonstration purpose\r\n                      const style = suggestion.active\r\n                        ? { backgroundColor: \"#ffffff\", cursor: \"pointer\" }\r\n                        : {\r\n                            backgroundColor: \"#ffffff\",\r\n                            cursor: \"pointer\",\r\n                          };\r\n                      return (\r\n                        <div\r\n                          {...getSuggestionItemProps(suggestion, {\r\n                            className,\r\n                            style,\r\n                          })}\r\n                          key={idx}\r\n                        >\r\n                          <div\r\n                            style={{ display: \"flex\", alignItems: \"center\" }}\r\n                            className=\"svg-and-location-additional\"\r\n                            {...getSuggestionItemProps(suggestion, {\r\n                              className,\r\n                              // style,\r\n                            })}\r\n                          >\r\n                            <LocationIcon\r\n                              height=\"20px\"\r\n                              width=\"20px\"\r\n                              fill=\"grey\"\r\n                            />\r\n                            <div className=\"location-input-result\">\r\n                              <p\r\n                                className=\"autocomplete-search-items-additional\"\r\n                                // onClick={handleSelectTerm}\r\n                              >\r\n                                {suggestion.description}\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </PlacesAutocomplete>\r\n          </div>\r\n          {/* <Geolocation\r\n            render={({ getCurrentPosition, fetchingPosition, position }) => (\r\n              <div>\r\n                <button className=\"profile-btn \" onClick={getCurrentPosition}>\r\n                  <span>Detect Current Location</span>\r\n                </button>\r\n              \r\n                <p>{position && position.coords.latitude}</p>\r\n                <p>{position && position.coords.longitude}</p>\r\n              </div>\r\n            )}\r\n          /> */}\r\n          <button\r\n            type=\"button\"\r\n            className=\"profile-btn detect-location-btn\"\r\n            onClick={ getLocation}\r\n          >\r\n            <img\r\n            className=\"location-icon \"\r\n            src={LocationIocn}\r\n            alt=\"icon\"\r\n            />\r\n            Detect Current Location\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <label className=\"m-b-1\">Recent Location</label>\r\n      <div className=\"input-group mb-1\">\r\n        <label className=\"  \">\r\n          <img width=\"20\" height=\"20\" src={tradie_service_location_2} alt=\"\" />\r\n          {tradiaServiceLocation ? tradiaServiceLocation[0]?.address : \"\"}\r\n        </label>\r\n      </div>\r\n\r\n      <div className=\"input-group btn\">\r\n        <input\r\n          type=\"submit\"\r\n          className=\"btn-primary\"\r\n          onClick={(e) => {\r\n            submitServiceLocation(e);\r\n          }}\r\n          value=\"Save\"\r\n        />\r\n      </div>\r\n    </>\r\n  );\r\n};\r\nexport default AutoCompleteSearch;\r\n"]},"metadata":{},"sourceType":"module"}